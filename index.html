<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Progress Cetakan Tahunan</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
    }
    h1 { color: #ff6600; font-size: 20px; }
    .cards {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    .container {
      flex: 1 1 300px;
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 5px;
    }
    input[type=number] {
      width: 100%;
      padding: 6px;
      margin: 6px 0;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background: #ff6600;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 5px;
    }
    button:hover { background: #e65c00; }
    .progress {
      margin-top: 10px;
      width: 100%;
      background: #ddd;
      border-radius: 20px;
      overflow: hidden;
    }
    .progress-bar {
      height: 20px;
      background: #ff6600;
      width: 0%;
      text-align: center;
      color: white;
      line-height: 20px;
      transition: width 0.5s;
    }
    .chart-container {
      margin-top: 10px;
      text-align: center;
    }
    canvas { max-width: 200px; }
    .data-list { margin-top: 10px; }
    .data-list ul { padding-left: 20px; font-size: 14px; }
  </style>
</head>
<body>
  <h1>Dashboard Cetakan (14 Card)</h1>

  <div class="cards">
    <!-- 14 Card -->
    <script>
      // generate card html dengan JS agar tidak ngetik panjang
      let cardNames = [
        "Suri Offset","Mesin 2","Mesin 3","Mesin 4","Mesin 5","Mesin 6","Mesin 7",
        "Mesin 8","Mesin 9","Mesin 10","Mesin 11","Mesin 12","Mesin 13","Mesin 14"
      ];
      for (let i=1;i<=14;i++){
        document.write(`
        <div class="container">
          <h1>Target ${cardNames[i-1]}</h1>

          <label>Target Cetakan</label>
          <input type="number" id="target${i}" placeholder="Masukkan target cetakan">
          <button onclick="simpanTarget(${i})">Simpan Target</button>

          <label>Input Cetakan Hari Ini</label>
          <input type="number" id="inputCetakan${i}" placeholder="Masukkan jumlah cetakan">
          <button onclick="tambahData(${i})">Tambah Data</button>

          <div class="progress">
            <div class="progress-bar" id="progressBar${i}">0%</div>
          </div>

          <h3>Total Cetakan: <span id="totalCetakan${i}">0</span></h3>
          <h3>Pencapaian: <span id="persentase${i}">0%</span></h3>

          <div class="chart-container">
            <canvas id="pieChart${i}"></canvas>
          </div>

          <div class="data-list">
            <h3>Riwayat Input:</h3>
            <ul id="riwayat${i}"></ul>
          </div>
        </div>
        `);
      }
    </script>
  </div>

  <script>
    let dataCetakan = {};
    let targetCetakan = {};
    let charts = {};

    function initChart(id){
      let ctx=document.getElementById("pieChart"+id).getContext("2d");
      charts[id]=new Chart(ctx,{
        type:"doughnut",
        data:{labels:["Tercapai","Sisa"],datasets:[{data:[0,100],backgroundColor:["#ff6600","#ddd"]}]},
        options:{responsive:true,plugins:{legend:{position:"bottom"}}}
      });
    }

    function renderData(id){
      let total=(dataCetakan[id]||[]).reduce((a,b)=>a+b,0);
      let target=targetCetakan[id]||0;
      let persen=target>0?((total/target)*100).toFixed(2):0;

      document.getElementById("totalCetakan"+id).innerText=total;
      document.getElementById("persentase"+id).innerText=persen+"%";

      let pb=document.getElementById("progressBar"+id);
      pb.style.width=Math.min(persen,100)+"%";
      pb.innerText=persen+"%";

      charts[id].data.datasets[0].data=[persen,100-persen];
      charts[id].update();

      let riw=document.getElementById("riwayat"+id);
      riw.innerHTML="";
      (dataCetakan[id]||[]).forEach((val,idx)=>{
        let li=document.createElement("li");
        li.innerText=`Input ${idx+1}: ${val} cetakan`;
        riw.appendChild(li);
      });
    }

    function simpanTarget(id){
      let newTarget=parseInt(document.getElementById("target"+id).value);
      if(!newTarget||newTarget<=0){alert("Masukkan target valid!");return;}
      targetCetakan[id]=newTarget;
      renderData(id);
    }

    function tambahData(id){
      let input=parseInt(document.getElementById("inputCetakan"+id).value);
      if(!input||input<=0){alert("Masukkan jumlah cetakan valid!");return;}
      if(!dataCetakan[id]) dataCetakan[id]=[];
      dataCetakan[id].push(input);
      document.getElementById("inputCetakan"+id).value="";
      renderData(id);
    }

    // Inisialisasi semua chart
    for (let i=1;i<=14;i++){ initChart(i); }
  </script>
</body>
</html>
